#!/bin/bash

# ANSI à¸ªà¸µà¹€à¸‚à¸µà¸¢à¸§
GREEN='\033[0;32m'
NC='\033[0m' # reset à¸ªà¸µ

while true; do
  clear

  # à¸”à¸¶à¸‡à¸‚à¸™à¸²à¸”à¸«à¸™à¹‰à¸²à¸ˆà¸­
  ROWS=$(tput lines)
  COLS=$(tput cols)

  # à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¹€à¸¡à¸™à¸¹
  MENU=$(cat << EOF
==============================
      ðŸ” Certificate Tool      
==============================
1. à¸ªà¸£à¹‰à¸²à¸‡ Root CA (create_root_ca.sh)
2. à¸ªà¸£à¹‰à¸²à¸‡ CSR (gen_csr.sh)
3. à¹à¸à¹‰à¹„à¸‚ SSL Extension (edit_ssl_ext.sh)
4. à¸¥à¸‡à¸™à¸²à¸¡ CSR (sign_csr.sh)
5. à¸­à¸­à¸ (Exit)
------------------------------
à¹€à¸¥à¸·à¸­à¸à¹€à¸¡à¸™à¸¹ (1-5): 
EOF
)

  # à¸„à¸³à¸™à¸§à¸“à¸šà¸£à¸£à¸—à¸±à¸”à¹€à¸£à¸´à¹ˆà¸¡à¸•à¹‰à¸™à¹€à¸žà¸·à¹ˆà¸­à¹ƒà¸«à¹‰à¹à¸ªà¸”à¸‡à¸•à¸£à¸‡à¸à¸¥à¸²à¸‡à¹à¸™à¸§à¸•à¸±à¹‰à¸‡
  LINE_COUNT=$(echo "$MENU" | wc -l)
  START_ROW=$(( (ROWS - LINE_COUNT) / 2 ))

  # à¸§à¸²à¸”à¹€à¸¡à¸™à¸¹à¸•à¸£à¸‡à¸à¸¥à¸²à¸‡
  IFS=$'\n'
  row=$START_ROW
  for line in $MENU; do
    line_length=${#line}
    col=$(( (COLS - line_length) / 2 ))
    tput cup $row $col
    echo -e "${GREEN}${line}${NC}"
    ((row++))
  done
  unset IFS

  # à¸­à¹ˆà¸²à¸™à¸„à¸³à¸•à¸­à¸š (à¸•à¸£à¸‡à¸à¸¥à¸²à¸‡à¸šà¸£à¸£à¸—à¸±à¸”à¸¥à¹ˆà¸²à¸‡)
  tput cup $((row)) $(( (COLS - 25) / 2 ))
  read -p "" choice

  case "$choice" in
    1)
      clear
      ./create_root_ca.sh
      read -p "à¸à¸” Enter à¹€à¸žà¸·à¹ˆà¸­à¸à¸¥à¸±à¸šà¹€à¸¡à¸™à¸¹à¸«à¸¥à¸±à¸..." ;;
    2)
      clear
      ./gen_csr.sh
      read -p "à¸à¸” Enter à¹€à¸žà¸·à¹ˆà¸­à¸à¸¥à¸±à¸šà¹€à¸¡à¸™à¸¹à¸«à¸¥à¸±à¸..." ;;
    3)
      clear
      ./edit_ssl_ext.sh
      read -p "à¸à¸” Enter à¹€à¸žà¸·à¹ˆà¸­à¸à¸¥à¸±à¸šà¹€à¸¡à¸™à¸¹à¸«à¸¥à¸±à¸..." ;;
    4)
      clear
      ./sign_csr.sh
      read -p "à¸à¸” Enter à¹€à¸žà¸·à¹ˆà¸­à¸à¸¥à¸±à¸šà¹€à¸¡à¸™à¸¹à¸«à¸¥à¸±à¸..." ;;
    5)
      echo -e "${GREEN}ðŸ‘‹ à¸­à¸­à¸à¸ˆà¸²à¸à¹‚à¸›à¸£à¹à¸à¸£à¸¡à¹à¸¥à¹‰à¸§à¸„à¸£à¸±à¸š${NC}"
      exit 0 ;;
    *)
      echo -e "${GREEN}âŒ à¸à¸£à¸¸à¸“à¸²à¹€à¸¥à¸·à¸­à¸ 1-5 à¹€à¸—à¹ˆà¸²à¸™à¸±à¹‰à¸™${NC}"
      read -p "à¸à¸” Enter à¹€à¸žà¸·à¹ˆà¸­à¹€à¸¥à¸·à¸­à¸à¹ƒà¸«à¸¡à¹ˆ..." ;;
  esac
done